@using TGP.Seguridad.BussinessLogic.Dto;
@model UsuarioDashboardViewModel


@{
    Layout = "~/Views/Shared/_LayoutBootstrap.cshtml";
    ViewBag.Title = "Seg - Editar Usuario";

}


<div class="uk-grid sigaf-titulo">
    <div class="uk-width-1-2">
        <h2 class="uk-margin-bottom">Editar Usuario | <span> <em>@Model.NombreUsuario</em></span></h2>
    </div>

</div>

<div class="uk-grid" data-uk-grid-margin data-uk-grid-match id="user_profile">
    <div class="uk-width-large-1-3">
        <div class="md-card">
            <div class="user_heading">
                <div class="user_heading_avatar uk-width-1-1 uk-flex uk-flex-center">
                    @if (Model.Avatar == null || Model.Avatar.Length == 0)
                    {
                        <div class="thumbnail">
                            <img alt="Foto de Perfil" src="~/Content/img/add_user.png" style="filter: brightness(2);width: 80%;margin: 8px 0 0 10px;">
                        </div>
                    }
                    else
                    {
                        <div class="thumbnail">
                            <img alt="Foto de Perfil" src="@Url.Action("GetAvatar", "Usuario", new { idUsuario = Model.Id})" />
                        </div>
                    }
                </div>
                <div class="user_heading_content uk-width-1-1 uk-flex uk-flex-center">
                    <h2 class="heading_b uk-margin-bottom">
                        <span class="uk-text-truncate">@Model.NombreUsuario</span>
                    </h2>
                </div>
            </div>
            <div class="user_content">
                <div class="uk-grid uk-flex uk-flex-center">
                    <ul class="md-list md-list-addon">
                        <li>
                            <div class="md-list-addon-element">
                                <i class="md-list-addon-icon material-icons">account_circle</i>
                            </div>
                            <div class="md-list-content">
                                <span class="md-list-heading">@Model.NombreUsuario</span>
                                <span class="uk-text-small uk-text-muted">Usuario</span>
                            </div>
                        </li>
                        <li>
                            <div class="md-list-addon-element">
                                <i class="md-list-addon-icon material-icons">label</i>
                            </div>
                            <div class="md-list-content">
                                <span class="md-list-heading">@Model.DescripcionTipoUsuario</span>
                                <span class="uk-text-small uk-text-muted">Tipo</span>
                            </div>
                        </li>
                        <li>
                            <div class="md-list-addon-element">
                                <i class="md-list-addon-icon material-icons">&#xE0CD;</i>
                            </div>
                            <div class="md-list-content">
                                <span class="md-list-heading">(@Model.CodigoAreaTelefono) @Model.NumeroTelefono @Model.NumeroInterno</span>
                                <span class="uk-text-small uk-text-muted">Telefono</span>
                            </div>
                        </li>
                        <li>
                            <div class="md-list-addon-element">
                                <i class="md-list-addon-icon material-icons">&#xE158;</i>
                            </div>
                            <div class="md-list-content">
                                <span class="md-list-heading">@Model.EMail</span>
                                <span class="uk-text-small uk-text-muted">Email</span>
                            </div>
                        </li>

                    </ul>
                </div>
                <div class="md-hr"></div>
                <div class="uk-flex uk-flex-center">
                    @if (Model.CodigoTipoUsuario.Equals(UsuarioDTO.USUARIONOMINADO))
                    {
                        <a id="btnUsuario" class="md-btn md-btn-accent" href="@Url.Action("EditarNominado", "Usuario", new { id = Model.Id })">Modificar</a>
                    }
                    else if (Model.CodigoTipoUsuario.Equals(UsuarioDTO.USUARIOACREEDOR))
                    {
                        <a id="btnUsuario" class="md-btn md-btn-accent" href="@Url.Action("EditarAcreedor", "Usuario", new { id = Model.Id })">Modificar</a>
                    }

                </div>
            </div>
        </div>
    </div>

    <div class="uk-width-large-1-3">
        <div class="md-card">
            <div class="user_heading">
                <div class="user_heading_avatar uk-width-1-1 uk-flex uk-flex-center">
                    <div class="thumbnail">
                        <i class="material-icons" style="font-size: 5em;margin: 6px 0 0 4px;">https</i>

                    </div>
                </div>
                <div class="user_heading_content uk-width-1-1 uk-flex uk-flex-center">
                    <h2 class="heading_b uk-margin-bottom">
                        <span class="uk-text-truncate">Aplicaciones Accesibles</span>
                    </h2>
                </div>
            </div>
            <div class="user_content">
                @foreach (ComboGenerico estructura in Model.Estructuras)
                {
                    <div class="uk-grid">
                        <div class="uk-width-1-1 uk-text-center without-icons md-color-grey-800">
                            @estructura.Descripcion
                        </div>
                    </div>
                    <hr class="uk-flex uk-flex-center prueba" style="margin: 7px 0;" />
                }
                <div class="md-hr"></div>
                <div class="uk-flex uk-flex-center">
                    <a href="@Url.Action("Permisos", "Usuario", new { id = Model.Id, tipoUsuario = Model.CodigoTipoUsuario })" id="btnPermisos" class="md-btn md-btn-accent">Modificar</a>
                </div>
            </div>
        </div>
    </div>
    <div class="uk-width-large-1-3">
        <div class="md-card">
            <div class="user_heading">
                <div class="user_heading_avatar uk-width-1-1 uk-flex uk-flex-center">
                    <div class="thumbnail">
                        <i style="font-size: 5em;margin: 6px 0 0 4px;" class="material-icons">security</i>
                    </div>
                </div>
                <div class="user_heading_content uk-width-1-1 uk-flex uk-flex-center">
                    <h2 class="heading_b uk-margin-bottom">
                        <span class="uk-text-truncate">Cambio de contraseña</span>
                    </h2>
                </div>
            </div>
            <div class="user_content">
                <div class="uk-grid uk-flex uk-flex-center">
                    <div class="uk-width-1-1 uk-text-center md-color-grey-800">
                        @if (Model.CodigoTipoAutenticacion.Equals(UsuarioDTO.INTERNA))
                        {
                            @Html.Raw("<i class='material-icons'>done</i>");
                        }
                        Autenticacion Interna de la Aplicacion


                    </div>

                </div>
                <hr class="uk-flex uk-flex-center" style="margin: 7px 0;" />
                <div class="uk-grid uk-flex uk-flex-center">
                    <div class="uk-width-1-1 uk-text-center md-color-grey-800">
                        @if (Model.CodigoTipoAutenticacion.Equals(UsuarioDTO.SIGAF))
                        {
                            @Html.Raw("<i class='material-icons'>done</i>");
                        }
                        Autenticacion SIGAF

                    </div>
                </div>
                <div class="md-hr"></div>
                <div class="uk-flex uk-flex-center">
                    @using (Html.BeginForm("CambiarClave", "Usuario", FormMethod.Post))
                    {
                        @Html.HiddenFor(m => m.Id)
                        @Html.HiddenFor(m => m.NombreUsuario)
                        @Html.HiddenFor(m => m.Version)
                        @Html.HiddenFor(m => m.CodigoTipoAutenticacion)
                        @Html.HiddenFor(m => m.CodigoTipoUsuario)
                        <button id="btnClave" type="submit" @*onclick="CambiarClave()"*@ class="md-btn md-btn-accent">Modificar</button>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
@section scripts{
    <script>
        $(document).ready(function () {
            activarMenu('#@ViewBag.MenuId');
            $(".prueba").last().hide();
        });

        function CambiarClave() {
            $("#form0").submit();
            @*$.post({
                url: '@Url.Action("CambiarClave", "Usuario")',
                data: {
                    id: @Model.Id,
                    nombre: '@Model.NombreUsuario',
                    version: @Model.Version,
                    tipoAutenticacion: '@Model.CodigoTipoAutenticacion',
                    tipoUsuario: '@Model.CodigoTipoUsuario'
                }
            });*@
        }
    </script>

}