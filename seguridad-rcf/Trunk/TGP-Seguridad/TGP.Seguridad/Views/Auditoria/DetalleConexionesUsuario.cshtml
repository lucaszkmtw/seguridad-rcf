@using TGP.Seguridad.BussinessLogic.Dto
@model DetalleConexionesUsuario


@{
    ViewBag.Title = "Seg - Datos de Auditoría";
    Layout = "~/Views/Shared/_LayoutBootstrap.cshtml";
}

<div class="uk-grid sigaf-titulo">
    <div class="uk-width-1-2">
        <h2 class="uk-margin-bottom">Datos de Auditoría</h2>
    </div>
</div>

<div class="md-card">
    <div class="md-card-content">
        <h3 class="uk-margin-bottom">Detalle de Conexiones</h3>
        <div class="uk-grid uk-margin-top uk-grid-match" data-uk-grid-margin data-uk-grid-match="{target:'.uk-width-medium-1-3'}">
            <div class="uk-width-medium-1-3">
                <span>
                    <strong>Usuario: </strong> @Model.NombreUsuario (@Model.DescripcionUsuario)
                </span>
            </div>
            <div class="uk-width-medium-1-3">
                <span><strong>Desde: </strong>@string.Format("{0:dd/MM/yyyy}", Model.FechaDesde)</span>
            </div>
            <div class="uk-width-medium-1-3">
                <span><strong> Hasta: </strong>@string.Format("{0:dd/MM/yyyy}", Model.FechaHasta)</span>
            </div>
        </div>
    </div>
</div>


<div class="md-card uk-margin-bottom">
    <div class="md-card-content">
        <div id="div-resultados">
            <table id="datos-conexiones" class="uk-table" cellspacing="0" width="100%">
                <thead>
                    <tr>

                        <th>APP</th>
                        <th>Fecha de Conexión</th>
                        <th>IP de Conexión</th>
                        <th>Navegador</th>
                        <th>Servidor</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (AuditoriaDeConexionesDTO conexion in Model.Conexiones)
                    {
                        <!-- un registro -->
                        <tr>
                            <td>
                                <span class="uk-badge uk-badge-success uk-badge-notification">@conexion.EstructuraFuncionalCodigo</span>
                            </td>
                            <td>@string.Format("{0:dd/MM/yyyy HH:mm:ss}", conexion.FechaConexion)</td>
                            <td>@conexion.IPConexion</td>
                            <td>@conexion.Browser</td>
                            <td>@conexion.Server</td>


                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

@section scripts{
    <script>
            $(document).ready(function () {
                activarMenu("#listado-Auditoria");


                $('#datos-conexiones').dataTable({
                    "scrollX": true,
                    iDisplayLength: 25,
                    aaSorting: [[1, "asc"]],
                    dom: "<'uk-grid' <'uk-width-large-1-2 countCheck'><'uk-width-large-1-2 uk-flex uk-flex-right'<'agregarNuevoDestBtn uk-margin-right'><'eliminarDestBtn'>>>" +
                    "<'uk-grid uk-margin-small-bottom'<'uk-width-large-3-10'l><'uk-width-large-3-10 uk-padding-remove'f> <'uk-width-large-4-10 uk-padding-remove uk-flex uk-flex-right'B>>tirp",
                    colVis: {
                        buttonText: '<i class="fa fa-eye" title="Mostrar / Ocultar"></i>',
                        restore: "Reestablecer",
                        showAll: "Mostrar Todas"
                    },
                    aoColumnDefs: [
                        { sType: "de_datetime", aTargets: [1] },

                    ],
                    "lengthMenu": [[25, 50, 100, 300], [25, 50, 100, 300]],
                    buttons: [
                        { extend: 'copy', className: 'md-btn md-btn-small', text: 'Copiar' },
                        { extend: 'csv', title: 'Datos de Auditoría', className: 'md-btn md-btn-small' },
                        { extend: 'pdf', title: 'Datos de Auditoría', className: 'md-btn md-btn-small', orientation: 'landscape', exportOptions: { columns: [0, 1, 2, 3, 4], }, customize: function (doc) { doc.defaultStyle.alignment = 'landscape'; } },
                        { extend: 'print', className: 'md-btn md-btn-small', text: 'Imprimir' }
                    ],
                    language: agregarLenguajeDatatable(),
                });
            });
    </script>


}

